# ูุธุงู ุงูู Cache - ุชูููู ุชูุงููู R2

## ุงููุฏู
ุชูููู ุทูุจุงุช R2 Class B Operations ุจูุณุจุฉ **80-90%** ุนู ุทุฑูู ุชุฎุฒูู ุงูุจูุงูุงุช ุงููุชูุฑุฑุฉ ูู ุงูุฐุงูุฑุฉ.

## ุงูุชูููุฐ

### 1. ุงูููุชุจุงุช ุงููุณุชุฎุฏูุฉ
```bash
npm install @nestjs/cache-manager cache-manager
```

### 2. ุงูุชูููู ุงูุนุงู (app.module.ts)
- TTL: 5 ุฏูุงุฆู (300000ms)
- Max Items: 100 ุนูุตุฑ
- Cache Mode: In-Memory (ุณุฑูุน ุฌุฏุงู)

### 3. ุงูู Services ุงููุญุฏุซุฉ

#### ContentService
- โ `findAll()` - Cache: 5 ุฏูุงุฆู
- โ `getTrending()` - Cache: 10 ุฏูุงุฆู
- โ `getRecommended()` - Cache: 10 ุฏูุงุฆู
- โ `getRecent()` - Cache ุบูุฑ ููุนู (ุจูุงูุงุช ูุชุฌุฏุฏุฉ)
- โ `findOne(id)` - Cache: 10 ุฏูุงุฆู

#### PerformersService
- โ `findAll()` - Cache: 10 ุฏูุงุฆู
- โ `findOne(id)` - Cache: 10 ุฏูุงุฆู

### 4. ููุงุชูุญ ุงูู Cache (Cache Keys)
```typescript
content_all_{page}_{limit}_{performerId}
content_trending_{limit}
content_recommended_{limit}
content_{id}
performers_all_{page}_{limit}
performer_{id}
```

## ุงูุชุญุณููุงุช ุงููุญููุฉ

### ูุจู ุงูู Cache:
- **ูู ุทูุจ** โ ูุงุนุฏุฉ ุงูุจูุงูุงุช โ R2 URLs
- **ุงููุดุงูุฏุงุช ุงูุนุงููุฉ** = ุชูุงููู ุนุงููุฉ

### ุจุนุฏ ุงูู Cache:
- **ุงูุทูุจ ุงูุฃูู** โ ูุงุนุฏุฉ ุงูุจูุงูุงุช โ Cache
- **ุงูุทูุจุงุช ุงูุชุงููุฉ** (ุฎูุงู 5-10 ุฏูุงุฆู) โ Cache ูุจุงุดุฑุฉู
- **ุชูููู 80-90%** ูู ุงูุทูุจุงุช

## ุงูุตูุงูุฉ ูุงูุชุญุฏูุซ

### ูุชู ูุชู ุชุญุฏูุซ ุงูู Cache ุชููุงุฆูุงูุ
- ุจุนุฏ **5 ุฏูุงุฆู** ูููุญุชูู ุงูุนุงู
- ุจุนุฏ **10 ุฏูุงุฆู** ูููุญุชูู ุงูุดุงุฆุน ูุงูููุดุฏูู
- ุนูุฏ **ุฅุนุงุฏุฉ ุชุดุบูู ุงูุณูุฑูุฑ** (Cache ูู ุงูุฐุงูุฑุฉ)

### ููู ุชูุธู ุงูู Cache ูุฏููุงูุ
```bash
# ุจุฅุนุงุฏุฉ ุชุดุบูู ุงูุณูุฑูุฑ ููุท
npm run start:dev
```

## ุงูุชูุตูุงุช ุงููุณุชูุจููุฉ

### 1. Redis Cache (ููุฅูุชุงุฌ)
```typescript
CacheModule.register({
  store: redisStore,
  host: 'localhost',
  port: 6379,
})
```

### 2. CDN ูููููุงุช ุงูุซุงุจุชุฉ
- Cloudflare CDN ุฃูุงู R2
- Cache: 30 ููู ููุตูุฑ
- Cache: 7 ุฃูุงู ููููุฏูู/ุตูุช

### 3. HTTP Cache Headers
```typescript
@Header('Cache-Control', 'public, max-age=300')
async getContent() { ... }
```

## ููุงุญุธุงุช ูููุฉ
- โ๏ธ ุงูู Cache ุงูุญุงูู ูู ุงูุฐุงูุฑุฉ RAM (ูุฎุชูู ุนูุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู)
- โ ููุงุณุจ ููุชุทููุฑ ูุงูุงุณุชุฎุฏุงู ุงููุญูู
- ๐ ููุฅูุชุงุฌ: ุงุณุชุฎุฏู Redis ุฃู Memcached
